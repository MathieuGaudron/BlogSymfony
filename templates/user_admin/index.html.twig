{% extends 'base.html.twig' %}

{% block title %}Admin - Utilisateurs{% endblock %}

{% block body %}
<div class="auth-bg py-5">
  <div class="container">
    <div class="auth-card shadow-lg">
      <div class="p-4 p-md-5">

        <h1 class="auth-title h3 mb-4">Utilisateurs</h1>

        {% for message in app.flashes('error') %}
          <div class="alert alert-danger">{{ message }}</div>
        {% endfor %}
        {% for message in app.flashes('success') %}
          <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        <div class="table-responsive">
          <table class="table table-dark table-hover align-middle mb-0" style="--bs-table-bg: transparent;">
            <thead>
              <tr>
                <th>ID</th>
                <th>Email</th>
                <th>Prénom</th>
                <th>Nom</th>
                <th>Statut</th>
                <th class="text-end">Action</th>
              </tr>
            </thead>
            <tbody>
              {% for user in users %}
                <tr>
                  <td>{{ user.id }}</td>
                  <td>{{ user.email }}</td>
                  <td>{{ user.firstName }}</td>
                  <td>{{ user.lastName }}</td>
                  <td>
                    {% if user.isActive %}
                      <span class="badge text-bg-success">Actif</span>
                    {% else %}
                      <span class="badge text-bg-danger">Désactivé</span>
                    {% endif %}
                  </td>
                  <td class="text-end">
                    <form method="post" action="{{ path('admin_users_toggle', {id: user.id}) }}">
                      <input type="hidden" name="_token" value="{{ csrf_token('toggle_user_' ~ user.id) }}">
                      {% if user.isActive %}
                        <button class="btn btn-sm btn-outline-warning">Désactiver</button>
                      {% else %}
                        <button class="btn btn-sm btn-outline-success">Activer</button>
                      {% endif %}
                    </form>
                  </td>
                </tr>
              {% else %}
                <tr>
                  <td colspan="6" class="text-center auth-label py-4">Aucun utilisateur.</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="mt-4">
          <a class="auth-link" href="{{ path('admin_dashboard') }}">← Retour dashboard</a>
        </div>

      </div>
    </div>
  </div>
</div>
{% endblock %}
